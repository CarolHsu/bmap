<!DOCTYPE html>
<html>

  <head>
    <title>Bmap_demo</title>
    <meta cherset="utf-8" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
    <script src="http://api.map.baidu.com/api?v=1.3" type="text/javascript"></script>

    
    <style type="text/css">
      body {
      }
    </style>
    <link rel="stylesheet" type="text/css" href="stylesheet/bootstrap/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="stylesheet/bootstrap/css/bootstrap-responsive.css" />
    <link rel="stylesheet" type="text/css" href="stylesheet/main.css" />
  </head>

  <body>

    <script type="text/javascript" src="script/jquery-1.8.1.min.js"></script>
    <script type="text/javascript" src="stylesheet/bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
      $('.carousel').carousel();
    });
    </script>

    <div id="header" class="container-fluid">
      <div class="span1">
      </div>
      <div class="span10">
         <div id="myCarousel" class="carousel slide head-shadow"> 
                <div class="carousel-inner">
                  <div class="item active">
                    <img src="stylesheet/image/head/banner-001.JPG" alt="">
                    <div class="carousel-caption">
                      <h4>巴城 即时交通信息网</h4>BACHEN TOWN ATIS WEB
                    </div>
                  </div>
                  <div class="item">
                    <img src="stylesheet/image/head/banner-002.jpg" alt="">
                    <div class="carousel-caption">
                      <h4>巴城 即时交通信息网</h4>BACHEN TOWN ATIS WEB
                    </div>
                  </div>
                  <div class="item">
                    <img src="stylesheet/image/head/banner-003.jpg" alt="">
                    <div class="carousel-caption">
                      <h4>巴城 即时交通信息网</h4>BACHEN TOWN ATIS WEB
                    </div>
                  </div>
                  <div class="item">
                    <img src="stylesheet/image/head/banner-004.jpg" alt="">
                    <div class="carousel-caption">
                      <h4>巴城 即时交通信息网</h4>BACHEN TOWN ATIS WEB
                    </div>
                  </div>
                  <div class="item">
                    <img src="stylesheet/image/head/banner-005.jpg" alt="">
                    <div class="carousel-caption">
                      <h4>巴城 即时交通信息网</h4>BACHEN TOWN ATIS WEB
                    </div>
                  </div>
                </div>
                <a class="left carousel-control" href="#myCarousel" data-slide="prev">‹</a>
                <a class="right carousel-control" href="#myCarousel" data-slide="next">›</a>
              </div>
      </div>
      <div class="span1"></div>
    </div>
    

    <div id="menu" class="row">
      <div class="navbar navbar-inverse">
        <div class="navbar-inner">
          <div class="container-fluid">
            <a class="btn btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                  <li><a onclick="showPolyline()" onmouseover="this.style.cursor='pointer'"><img src="stylesheet/image/road.gif">  即时路段绩效</a></li>       
                  <li><a onclick="showVD()" onmouseover="this.style.cursor='pointer'"><img src="stylesheet/image/vd.gif">  车辆侦测器</a></li>
                  <li><a onclick="showCMS()" onmouseover="this.style.cursor='pointer'"><img src="stylesheet/image/cms.gif">  信息可变标志面版</a></li>
                  <!--
                  <li><a href="#"><img src="stylesheet/image/cctv.gif">  即时路况影像</a></li>
                  <li><a href="#"><img src="stylesheet/image/avi.png">  旅行时间推估</a></li>
                  <li><a href="#"><img src="stylesheet/image/fog.gif">  浓雾侦测</a></li>
                  <li><a href="#"><img src="stylesheet/image/water.gif">  水位侦测</a></li>
                  <li><a href="#"><img src="stylesheet/image/neighbor.png">  邻近县市设备信息</a></li>
                  <li><a href="#"><img src="stylesheet/image/warning.gif">  路况事件</a></li>
                  <li><a href="#"><img src="stylesheet/image/activity.gif">  定点活动讯息</a></li>
                  -->
              </ul>
              <ul class="nav pull-right">
                <li><a>资料最后更新时刻 - 2012 年 11 月 15 日 09:45:26</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="content" class="container-fluid">
      <div class="alert alert-error horselight head-shadow">
        7/23至11/30 国道3号中和汐止系统交流道夜间施工管制，请依指示牌面及工程施工单位所设导引牌面说明行驶。
      </div>
      <div class="row-fluid">
        <div id="map" class="span12 well head-shadow"></div>
        <div id="sidebar" class="span2" style="position:fixed; top:380px; right:30px;">
          <table class="table table-bordered table-condensed table-hover" style="background-color:#fff;">
            <tr>
              <td colspan="2" style="text-align:center;" class="breadcrumb">一般道路</td>
            </tr>
            <tr>
              <td style="background-color:#aaa;width:25px;"></td>
              <td>无资料</td>
            </tr>
            <tr>
              <td style="background-color:#ff0000;"></td>
              <td>时速19公里以下</td>
            </tr>
            <tr>
              <td style="background-color:#ff9900;"></td>
              <td>时速20-39公里</td>
            </tr>
            <tr>
              <td style="background-color:#009900;"></td>
              <td>时速40公里以上</td>
            </tr>
          </table>
        </div>
      </div>
    </div>

  </body>

</html>

<script type="text/javascript">
var scrollAmount = 0;

function scr() {
    window.scrollBy(0,5);
    scrollAmount += 5;
    if(scrollAmount < 300) {
        scrolldelay = setTimeout('scr()',1);
    }
}

function updateTime(){
  var hour        = now.getHours();
  var minute      = now.getMinutes();
  var second      = now.getSeconds();
  var monthnumber = now.getMonth();
  var monthday    = now.getDate();
  var year        = now.getYear();
}


var map = new BMap.Map("map");            // 创建Map实例
var point = new BMap.Point(120.8792,31.4570);    // 创建点坐标
map.centerAndZoom(point,15);                     // 初始化地图,设置中心点坐标和地图级别。
map.enableScrollWheelZoom();                            //启用滚轮放大缩小
//左鍵坐標
map.addEventListener("click",function(e){
    alert(e.point.lng + "," + e.point.lat);
});

//json
var routes;
var cmses;
var vds;
var data;

function loadDATA(callback){
  $.ajax({
    url:"JSON/data.json",
    type:"GET",
    dataType:"json",
    success: function(json){
      // alert("do!");
      data = json;
      //setTimeout(loadDATA(), 60000);
    },
    error: function(){
      alert("error...");
    }
  });
}
// var data = loadDATA();
setTimeout(loadDATA(), 10);

function showCMS(){
  map.clearOverlays();
  cmses = new Array(data.cms.length);
  for(var i = 0; i < data.cms.length; i++){
    var myIcon = new BMap.Icon("stylesheet/image/cms.gif", new BMap.Size(35,35));
    cmses[i] = new BMap.Marker(new BMap.Point(data.cms[i].lng,data.cms[i].lat),{icon:myIcon});
    map.addOverlay(cmses[i]);
    cmses[i].setAnimation(BMAP_ANIMATION_BOUNCE);
    cmses[i].show();
  }
}

function showVD(){
  map.clearOverlays();
  vds = new Array(data.vd.length);
  for(var i = 0; i < data.vd.length; i++){
    var myIcon = new BMap.Icon("stylesheet/image/vd.gif", new BMap.Size(35,35));
    vds[i] = new BMap.Marker(new BMap.Point(data.vd[i].lng,data.vd[i].lat),{icon:myIcon});
    map.addOverlay(vds[i]);
    vds[i].setAnimation(BMAP_ANIMATION_BOUNCE);
    vds[i].show();
  }
}

function showPolyline(){
  map.clearOverlays();
  routes = new Array(data.route.length);
  for(var i = 0; i < data.route.length; i++){
    var color;
    var points = new Array(data.route[i].points.length);
    if(data.route[i].speed < 19){
      color = "#ff0000";
    }
    else if(data.route[i].speed >= 19 && data.route[i].speed < 40){
      color = "#ff9900";
    }
    else{
      color = "#009900"
    }
    for(var j = 0; j < data.route[i].points.length; j++){
      points[j] = new BMap.Point(data.routes[i].points[j].lng,data.routes[i].points[j].lat);
    }
    routes[i] = new BMap.Polyline(points,{strokeColor:color, strokeWeight:6, strokeOpacity:0.5});
    map.addOverlay(routes[i]);
  }
}



// var polyline1 = new BMap.Polyline([
//   new BMap.Point(120.859869,31.465655),
//   new BMap.Point(120.865258,31.465039),
//   new BMap.Point(120.877978,31.465347),
//   new BMap.Point(120.878338,31.460604),
//   new BMap.Point(120.879559,31.456723),
//   new BMap.Point(120.883799,31.456784),
//   new BMap.Point(120.887752,31.458571),
//   new BMap.Point(120.891633,31.460912)
// ], {strokeColor:"#ff9900", strokeWeight:6, strokeOpacity:0.5});
// map.addOverlay(polyline1);
// var polyline2 = new BMap.Polyline([
//   new BMap.Point(120.892208,31.48321),
//   new BMap.Point(120.891776,31.449761),
//   new BMap.Point(120.892136,31.431029)
// ], {strokeColor:"#009900", strokeWeight:6, strokeOpacity:0.5});
// map.addOverlay(polyline2);
// var polyline3 = new BMap.Polyline([
//   new BMap.Point(120.855988,31.464423),
//   new BMap.Point(120.854622,31.457277),
//   new BMap.Point(120.8557,31.456107),
//   new BMap.Point(120.854407,31.451301)
// ], {strokeColor:"#ff0000", strokeWeight:6, strokeOpacity:0.5});
// map.addOverlay(polyline3);

// var pt = new BMap.Point(120.891992,31.460912);
// var myIcon = new BMap.Icon("stylesheet/image/vd.gif", new BMap.Size(35,35));
// var marker1 = new BMap.Marker(pt,{icon:myIcon});  // 创建标注
// map.addOverlay(marker1);
// marker1.setAnimation(BMAP_ANIMATION_BOUNCE);

// var pt = new BMap.Point(120.879559,31.456846);
// var myIcon = new BMap.Icon("stylesheet/image/cms.gif", new BMap.Size(35,35));
// var marker2 = new BMap.Marker(pt,{icon:myIcon});  // 创建标注
// map.addOverlay(marker2);
// marker2.setAnimation(BMAP_ANIMATION_BOUNCE);

// polyline1.hide();
// polyline2.hide();
// polyline3.hide();
// marker1.hide();
// marker2.hide();

// function showPolyline(){
//   scrollAmount = 0;
//   scr();
//   polyline1.show();
//   polyline2.show();
//   polyline3.show();
//   marker1.hide();
//   marker2.hide();
// }

// function showVD(){
//   scrollAmount = 0;
//   scr();
//   polyline1.hide();
//   polyline2.hide();
//   polyline3.hide();
//   marker1.show();
//   marker2.hide();
  
// }

// function showCMS(){
//   scrollAmount = 0;
//   scr();
//   polyline1.hide();
//   polyline2.hide();
//   polyline3.hide();
//   marker1.hide();
//   marker2.show();  
// }


</script>
